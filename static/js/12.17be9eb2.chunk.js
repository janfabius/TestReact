(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{205:function(e,t,a){"use strict";var n=a(11),r=a(1),l=a.n(r),c=(a(27),a(36)),i=a(237),o=a(238),s=a(58),u=c.a.create("page"),m=function(e){var t=e.title,a=e.breadcrumbs,r=e.tag,c=e.className,m=e.children,d=Object(n.a)(e,["title","breadcrumbs","tag","className","children"]),p=u.b("px-3",c);return l.a.createElement(r,Object.assign({className:p},d),l.a.createElement("div",{className:u.e("header")},t&&"string"===typeof t?l.a.createElement(s.a,{type:"h1",className:u.e("title")},t):t,a&&l.a.createElement(i.a,{className:u.e("breadcrumb")},l.a.createElement(o.a,null,"Home"),a.length&&a.map(function(e,t){var a=e.name,n=e.active;return l.a.createElement(o.a,{key:t,active:n},a)}))),m)};m.defaultProps={tag:"div",title:""},t.a=m},207:function(e,t,a){"use strict";var n=a(1),r=a.n(n),l=a(197),c=a(198),i=a(181),o=a(182),s=a(183);t.a=function(e){return r.a.createElement(l.a,null,r.a.createElement(c.a,{md:6},r.a.createElement(i.a,null,r.a.createElement(o.a,{for:"from"},"Da"),r.a.createElement(s.a,{type:"date",name:"from",id:"from",placeholder:"Data inizio",defaultValue:e.fromStartDate,onChange:function(t){return e.onChange(t.target.value,"from")}}))),r.a.createElement(c.a,{md:6},r.a.createElement(i.a,null,r.a.createElement(o.a,{for:"exampleDate"},"A"),r.a.createElement(s.a,{type:"date",name:"date",id:"to",placeholder:"Data Fine",defaultValue:e.toStartDate,onChange:function(t){return e.onChange(t.target.value,"to")}}))))}},208:function(e,t,a){"use strict";var n=a(12),r=a(13),l=a(15),c=a(14),i=a(16),o=a(1),s=a.n(o),u=a(212),m=function(e){function t(){return Object(n.a)(this,t),Object(l.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){u.isMobile&&document.querySelector(".cr-sidebar").classList.toggle("cr-sidebar--open")}}]),t}(s.a.Component);t.a=m},209:function(e,t,a){"use strict";var n=a(1),r=a.n(n);t.a=function(e){return r.a.createElement("tr",null,r.a.createElement("td",{colSpan:e.colspan},e.children||"Nessun dato presente"))}},210:function(e,t,a){"use strict";t.a=function(e){var t=new Date(e),a=""+(t.getMonth()+1),n=""+t.getDate(),r=t.getFullYear();return a.length<2&&(a="0"+a),n.length<2&&(n="0"+n),[r,a,n].join("-")}},223:function(e,t,a){"use strict";var n=a(59),r=a(1),l=a.n(r),c=a(197),i=a(198),o=a(181),s=a(182),u=a(211),m=a(10);t.a=function(e){var t=Object(r.useState)(null),a=Object(n.a)(t,2),d=a[0],p=a[1];return l.a.createElement(c.a,null,l.a.createElement(i.a,{md:6},l.a.createElement(o.a,null,l.a.createElement(s.a,{for:"exampleUrl"},"Gruppo Cliente"),l.a.createElement(u.a,{isClearable:!0,cacheOptions:!0,loadOptions:function(e){var t="customer-groups".concat(e?"?filter[text]="+e:"");return m.a.get(t).then(function(e){return e.data.data.map(function(e){return{value:e.id,label:e.attributes.description}})}).catch(function(e){console.log("some error",e)})},defaultOptions:!0,onChange:function(t){return function(t){var a=t?t.value:null;e.onChange(a,"customer_group_id"),p(a)}(t)}}))),l.a.createElement(i.a,{md:6},l.a.createElement(o.a,null,l.a.createElement(s.a,{for:"exampleUrl"},"Cliente"),l.a.createElement(u.a,{isClearable:!0,loadOptions:function(e){var t="customers".concat(e?"?filter[text]="+e:"").concat(d?"&filter[group_id]="+d:"");return m.a.get(t).then(function(e){return e.data.data.map(function(e){return{value:e.id,label:e.attributes.business_name}})}).catch(function(e){console.log("some error",e)})},defaultOptions:!0,onChange:function(t){return e.onChange(t.value,"customer_id")}}))))}},229:function(e,t,a){"use strict";var n=a(59),r=a(1),l=a.n(r),c=a(197),i=a(198),o=a(181),s=a(182),u=a(211),m=a(10);t.a=function(e){var t=Object(r.useState)(null),a=Object(n.a)(t,2),d=a[0],p=a[1],f=Object(r.useState)(null),h=Object(n.a)(f,2),E=h[0],b=h[1];return l.a.createElement(c.a,null,l.a.createElement(i.a,{md:4},l.a.createElement(o.a,null,l.a.createElement(s.a,{for:"exampleUrl"},"Gruppo Prodotto"),l.a.createElement(u.a,{isClearable:!0,cacheOptions:!0,loadOptions:function(e){var t="product-groups".concat(e?"?filter[text]="+e:"");return m.a.get(t).then(function(e){return e.data.data.map(function(e){return{value:e.id,label:e.attributes.description}})}).catch(function(e){console.log("some error",e)})},defaultOptions:!0,onChange:function(t){return function(t){var a=t?t.value:null;e.onChange(a,"product_group_id"),p(a)}(t)}}))),l.a.createElement(i.a,{md:4},l.a.createElement(o.a,null,l.a.createElement(s.a,{for:"exampleUrl"},"Reparto prodotto"),l.a.createElement(u.a,{isClearable:!0,loadOptions:function(e){var t="product-departments".concat(e?"?filter[text]="+e:"").concat(d?"&filter[group_id]="+d:"");return m.a.get(t).then(function(e){return e.data.data.map(function(e){return{value:e.attributes.code,label:e.attributes.description}})}).catch(function(e){console.log("some error",e)})},defaultOptions:!0,onChange:function(t){return function(t){var a=t?t.value:null;e.onChange(a,"product_department_id"),b(a)}(t)}}))),l.a.createElement(i.a,{md:4},l.a.createElement(o.a,null,l.a.createElement(s.a,{for:"exampleUrl"},"Prodotto"),l.a.createElement(u.a,{isClearable:!0,loadOptions:function(e){if(e.length>3){var t="products".concat(e?"?filter[text]="+e:"").concat(d?"&filter[group_id]="+d:"").concat(E?"&filter[department_id]="+E:"");return m.a.get(t).then(function(e){return e.data.data.map(function(e){return{value:e.id,label:e.attributes.description}})}).catch(function(e){console.log("some error",e)})}},defaultOptions:!0,onChange:function(t){return e.onChange(t.value,"product_id")}}))))}},432:function(e,t,a){"use strict";a.r(t);var n=a(12),r=a(13),l=a(15),c=a(14),i=a(16),o=a(205),s=a(1),u=a.n(s),m=a(19),d=a(191),p=a(197),f=a(198),h=a(172),E=a(177),b=a(173),g=a(192),v=a(178),C=a(427),x=a(30),S=a(207),O=a(223),_=a(229),y=a(10),j=a(17),N=a(48),D=a.n(N),k=a(42),w=a(9),F=a(209),T=a(218),A=a(210),P=a(208),U=new Date,L=function(e){function t(){var e,a;Object(n.a)(this,t);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).state={filters:{customer_group_id:null,customer_id:null,product_group_id:null,product_department_id:null,product_id:null,from:Object(A.a)(new Date(U.getFullYear(),U.getMonth(),1)),to:Object(A.a)(new Date)},searchClicked:!1},a.handleSubmit=function(){var e=a.state.searchClicked;a.setState({searchClicked:!e}),a.props.onLoadStats(null,null,a.state.filters,["customer","product"],null)},a.handleFilterChange=function(e,t){var n=a.state.filters;n[t]=e,a.setState({filters:n})},a.handlePdfClick=function(){var e=Object(j.a)(null,null,a.state.filters,["customer","product"],null);y.a.get("purchase-detail-products/pdf".concat(e)).then(function(e){fetch(e.data,{responseType:"blob"}).then(function(e){var t="acquisti_clienti_".concat(a.state.filters.from,"_").concat(a.state.filters.to,".pdf"),n=window.URL.createObjectURL(new Blob([e.data])),r=document.createElement("a");r.href=n,r.setAttribute("download",t),document.body.appendChild(r),r.click()})}).catch(function(e){a.notificationSystem&&a.notificationSystem.addNotification({title:u.a.createElement(w.f,null),message:"Errore nello scaricamento",level:"error"})})},a}return Object(i.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this,t=u.a.createElement(F.a,{colspan:5}),a=0,n=0;return this.props.loading&&this.state.searchClicked&&(t=u.a.createElement(F.a,{colspan:5},u.a.createElement(d.a,{color:"primary"}))),!1===this.props.loading&&!1===this.props.error&&null!==this.props.stats&&(t=this.props.stats.map(function(t,r){return a+=parseFloat(t.attributes.spent_amount),n+=parseFloat(t.attributes.spent_amount_previous_year),u.a.createElement("tr",{key:r},u.a.createElement("td",{className:"text-left"},e.props.customers[t.attributes.customer_id].business_name),u.a.createElement("td",{className:"text-left"},e.props.products[t.attributes.product_id].description),u.a.createElement("td",{className:"text-left"},t.attributes.day),u.a.createElement("td",{className:"text-right"},u.a.createElement(T.a,{value:t.attributes.spent_amount,displayType:"text",thousandSeparator:".",decimalSeparator:",",decimalScale:2,fixedDecimalScale:!0,renderText:function(e){return u.a.createElement("div",null,e)}})),u.a.createElement("td",{className:"text-right"},u.a.createElement(T.a,{value:t.attributes.spent_amount_previous_year,displayType:"text",thousandSeparator:".",decimalSeparator:",",decimalScale:2,fixedDecimalScale:!0,renderText:function(e){return u.a.createElement("div",null,e)}})))})),u.a.createElement(o.a,{title:"Punti clienti",breadcrumbs:[{name:"punti clienti",active:!0}]},u.a.createElement(p.a,null,u.a.createElement(f.a,null,u.a.createElement(h.a,{className:"mb-3"},u.a.createElement(E.a,null,"Filtri"),u.a.createElement(b.a,null,u.a.createElement(g.a,{onSubmit:this.handleSubmit},u.a.createElement(S.a,{onChange:this.handleFilterChange.bind(this),fromStartDate:this.state.filters.from,toStartDate:this.state.filters.to}),u.a.createElement(O.a,{onChange:this.handleFilterChange.bind(this)}),u.a.createElement(_.a,{onChange:this.handleFilterChange.bind(this)}),u.a.createElement(p.a,null,u.a.createElement(f.a,null,u.a.createElement(v.a,{color:"primary",disabled:this.props.loading&&this.state.searchClicked,onClick:this.handleSubmit},"Cerca")))))),u.a.createElement(h.a,{className:"mb-3"},u.a.createElement(E.a,null,u.a.createElement(v.a,{className:"float-right",color:"secondary",icon:"pdf",onClick:this.handlePdfClick,disabled:!this.props.pdfAvaiable},"PDF")),u.a.createElement(b.a,null,u.a.createElement(C.a,{responsive:!0},u.a.createElement("thead",null,u.a.createElement("tr",null,u.a.createElement("th",{className:"text-left"},"Cliente"),u.a.createElement("th",{className:"text-left"},"Articolo"),u.a.createElement("th",{className:"text-right"},"Data acquisto"),u.a.createElement("th",{className:"text-right"},"Valore speso \u20ac"),u.a.createElement("th",{className:"text-right"},"Valore speso anno precedente \u20ac"))),u.a.createElement("tbody",null,t),u.a.createElement("tfoot",null,u.a.createElement("tr",null,u.a.createElement("th",null),u.a.createElement("th",null),u.a.createElement("th",{className:"text-left"},"TOTALE:"),u.a.createElement("td",{className:"text-right"},u.a.createElement(T.a,{value:a,displayType:"text",thousandSeparator:".",decimalSeparator:",",decimalScale:2,fixedDecimalScale:!0,renderText:function(e){return u.a.createElement("div",null,e)}})),u.a.createElement("td",{className:"text-right"},u.a.createElement(T.a,{value:n,displayType:"text",thousandSeparator:".",decimalSeparator:",",decimalScale:2,fixedDecimalScale:!0,renderText:function(e){return u.a.createElement("div",null,e)}}))))))))),u.a.createElement(D.a,{dismissible:!1,ref:function(t){return e.notificationSystem=t},style:k.d}))}}]),t}(P.a);t.default=Object(m.connect)(function(e){return{stats:e.statistics.purchaseDetailStatistics,customers:e.statistics.customers,products:e.statistics.products,loading:e.statistics.loading,error:e.statistics.error,pdfAvaiable:e.statistics.pdfAvaiable}},function(e){return{onLoadStats:function(t,a,n,r,l){return e(x.m(t,a,n,r,l))}}})(L)}}]);
//# sourceMappingURL=12.17be9eb2.chunk.js.map