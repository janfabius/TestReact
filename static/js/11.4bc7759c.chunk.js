(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{205:function(e,t,a){"use strict";var r=a(11),n=a(1),l=a.n(n),c=(a(27),a(36)),i=a(237),o=a(238),s=a(58),u=c.a.create("page"),d=function(e){var t=e.title,a=e.breadcrumbs,n=e.tag,c=e.className,d=e.children,m=Object(r.a)(e,["title","breadcrumbs","tag","className","children"]),p=u.b("px-3",c);return l.a.createElement(n,Object.assign({className:p},m),l.a.createElement("div",{className:u.e("header")},t&&"string"===typeof t?l.a.createElement(s.a,{type:"h1",className:u.e("title")},t):t,a&&l.a.createElement(i.a,{className:u.e("breadcrumb")},l.a.createElement(o.a,null,"Home"),a.length&&a.map(function(e,t){var a=e.name,r=e.active;return l.a.createElement(o.a,{key:t,active:r},a)}))),d)};d.defaultProps={tag:"div",title:""},t.a=d},207:function(e,t,a){"use strict";var r=a(1),n=a.n(r),l=a(197),c=a(198),i=a(181),o=a(182),s=a(183);t.a=function(e){return n.a.createElement(l.a,null,n.a.createElement(c.a,{md:6},n.a.createElement(i.a,null,n.a.createElement(o.a,{for:"from"},"Da"),n.a.createElement(s.a,{type:"date",name:"from",id:"from",placeholder:"Data inizio",defaultValue:e.fromStartDate,onChange:function(t){return e.onChange(t.target.value,"from")}}))),n.a.createElement(c.a,{md:6},n.a.createElement(i.a,null,n.a.createElement(o.a,{for:"exampleDate"},"A"),n.a.createElement(s.a,{type:"date",name:"date",id:"to",placeholder:"Data Fine",defaultValue:e.toStartDate,onChange:function(t){return e.onChange(t.target.value,"to")}}))))}},208:function(e,t,a){"use strict";var r=a(12),n=a(13),l=a(15),c=a(14),i=a(16),o=a(1),s=a.n(o),u=a(212),d=function(e){function t(){return Object(r.a)(this,t),Object(l.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(n.a)(t,[{key:"componentDidMount",value:function(){u.isMobile&&document.querySelector(".cr-sidebar").classList.toggle("cr-sidebar--open")}}]),t}(s.a.Component);t.a=d},210:function(e,t,a){"use strict";t.a=function(e){var t=new Date(e),a=""+(t.getMonth()+1),r=""+t.getDate(),n=t.getFullYear();return a.length<2&&(a="0"+a),r.length<2&&(r="0"+r),[n,a,r].join("-")}},213:function(e,t,a){"use strict";var r=a(1),n=a.n(r),l=a(198),c=a(181),i=a(182),o=a(211),s=a(10);t.a=function(e){return n.a.createElement(l.a,{md:6},n.a.createElement(c.a,null,n.a.createElement(i.a,{for:"exampleUrl"},"Filiale"),n.a.createElement(o.a,{isClearable:!0,cacheOptions:!0,loadOptions:function(e){var t="affiliates".concat(e?"?filter[text]="+e:"");return s.a.get(t).then(function(e){return e.data.data.map(function(e){return{value:e.id,label:e.attributes.name}})}).catch(function(e){console.log("some error",e)})},defaultOptions:!0,onChange:function(t){return function(t){var a=t?t.value:null;e.onChange(a,"affiliate_id")}(t)}})))}},217:function(e,t,a){"use strict";a.d(t,"a",function(){return r});var r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"primary";return"undefined"===typeof window?null:window.getComputedStyle(document.documentElement).getPropertyValue("--".concat(e))}},229:function(e,t,a){"use strict";var r=a(59),n=a(1),l=a.n(n),c=a(197),i=a(198),o=a(181),s=a(182),u=a(211),d=a(10);t.a=function(e){var t=Object(n.useState)(null),a=Object(r.a)(t,2),m=a[0],p=a[1],f=Object(n.useState)(null),h=Object(r.a)(f,2),g=h[0],E=h[1];return l.a.createElement(c.a,null,l.a.createElement(i.a,{md:4},l.a.createElement(o.a,null,l.a.createElement(s.a,{for:"exampleUrl"},"Gruppo Prodotto"),l.a.createElement(u.a,{isClearable:!0,cacheOptions:!0,loadOptions:function(e){var t="product-groups".concat(e?"?filter[text]="+e:"");return d.a.get(t).then(function(e){return e.data.data.map(function(e){return{value:e.id,label:e.attributes.description}})}).catch(function(e){console.log("some error",e)})},defaultOptions:!0,onChange:function(t){return function(t){var a=t?t.value:null;e.onChange(a,"product_group_id"),p(a)}(t)}}))),l.a.createElement(i.a,{md:4},l.a.createElement(o.a,null,l.a.createElement(s.a,{for:"exampleUrl"},"Reparto prodotto"),l.a.createElement(u.a,{isClearable:!0,loadOptions:function(e){var t="product-departments".concat(e?"?filter[text]="+e:"").concat(m?"&filter[group_id]="+m:"");return d.a.get(t).then(function(e){return e.data.data.map(function(e){return{value:e.attributes.code,label:e.attributes.description}})}).catch(function(e){console.log("some error",e)})},defaultOptions:!0,onChange:function(t){return function(t){var a=t?t.value:null;e.onChange(a,"product_department_id"),E(a)}(t)}}))),l.a.createElement(i.a,{md:4},l.a.createElement(o.a,null,l.a.createElement(s.a,{for:"exampleUrl"},"Prodotto"),l.a.createElement(u.a,{isClearable:!0,loadOptions:function(e){if(e.length>3){var t="products".concat(e?"?filter[text]="+e:"").concat(m?"&filter[group_id]="+m:"").concat(g?"&filter[department_id]="+g:"");return d.a.get(t).then(function(e){return e.data.data.map(function(e){return{value:e.id,label:e.attributes.description}})}).catch(function(e){console.log("some error",e)})}},defaultOptions:!0,onChange:function(t){return e.onChange(t.value,"product_id")}}))))}},436:function(e,t,a){"use strict";a.r(t);var r=a(12),n=a(13),l=a(15),c=a(14),i=a(16),o=a(31),s=a(1),u=a.n(s),d=a(0),m=a.n(d),p=a(19),f=a(30),h=a(205),g=a(172),E=a(173),b=a(191),y=a(178),v=a(197),x=a(198),S=a(177),O=a(427),C=a(192),j=a(224),N=a(34),_=a.n(N),k=a(42),D=a(35),F=a(217),w=a(207),B=a(229),T=a(213),M=a(218),R=a(210),P=a(208),A=function(){return Object(o.a)({},k.a)},G=new Date,V=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(a=Object(l.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(i)))).state={filters:{from:Object(R.a)(new Date(G.getFullYear(),G.getMonth(),1)),to:Object(R.a)(new Date),product_group_id:null,product_department_id:null,product_id:null,quantity:0},groupBy:"groups",groupByRelation:"group",groupByFilterName:"product_group_id",searchClicked:!1,touched:!1},a.handleFilterChange=function(e,t){var r=a.state.filters;if(r[t]=e,a.setState({filters:r}),null===e)switch(t){case"product_group_id":a.changeGroupBy("");break;case"product_department_id":a.changeGroupBy("groups")}},a.handleSubmit=function(){var e=a.state.searchClicked;a.setState({searchClicked:!e,touched:!0}),a.props.onLoadStats(null,null,a.state.filters,["affiliate","product","group","department"],null)},a.handleDetailClick=function(e,t,r){a.handleFilterChange(e,t),a.handleSubmit(),a.changeGroupBy(r)},a.changeGroupBy=function(e){var t=a.state,r=t.groupBy,n=t.groupByRelation,l=t.groupByFilterName;switch(e){case"groups":r="departments",n="department",l="product_department_id";break;case"departments":r="families",n="family",l=null;break;default:r="groups",n="group",l="product_group_id"}a.setState({groupBy:r,groupByRelation:n,groupByFilterName:l})},a.handleReset=function(){var e=a.state.filters;Object.keys(e).forEach(function(t){e[t]=null}),a.setState({filters:e}),a.changeGroupBy("")},a}return Object(i.a)(t,e),Object(n.a)(t,[{key:"render",value:function(){var e=this,t=null,a=null,r=this.state,n=r.groupBy,l=r.groupByRelation,c=r.groupByFilterName,i=r.searchClicked,o=r.touched,s=this.props,d=s.products,m=s.loading,p=s.error,f=s.stats,N={labels:[],datasets:[{label:"Margine",borderColor:Object(F.a)("primary"),backgroundColor:Object(F.a)("primary"),data:[]}]},R={labels:[],datasets:[{label:"Profitto",borderColor:Object(F.a)("secondary"),backgroundColor:Object(F.a)("secondary"),data:[]}]};if(m&&i&&(t=u.a.createElement(g.a,null,u.a.createElement(E.a,null,u.a.createElement(b.a,{color:"primary"}))),a=u.a.createElement(g.a,null,u.a.createElement(E.a,null,u.a.createElement(b.a,{color:"primary"})))),!1===m&&!1===p&&null!==f&&!0===o){var P=this.props[n]?Object.keys(this.props[n]):[],G=Object.keys(f),V=G.length;t=P.map(function(t){var a=0,r=0,i=0,o=0,s=0,m=[],p=[],h=[],b=null;return N.labels.push(e.props[n][t].description),R.labels.push(e.props[n][t].description),c&&(b=u.a.createElement(y.a,{color:"secondary",onClick:function(){return e.handleDetailClick(t,c,n)}},"Visualizza dettagli")),u.a.createElement(v.a,{key:t},u.a.createElement(x.a,null,u.a.createElement(g.a,null,u.a.createElement(S.a,{className:"bg-primary text-white"},u.a.createElement("div",{className:"d-flex justify-content-between align-items-center"},u.a.createElement("span",null,e.props[n][t].description),b)),u.a.createElement(E.a,null,u.a.createElement(O.a,{responsive:!0},u.a.createElement("thead",null,u.a.createElement("tr",null,u.a.createElement("th",{className:"text-left"},"Prodotto"),u.a.createElement("th",{className:"text-right"},"Quantit\xe0"),u.a.createElement("th",{className:"text-right"},"Medio \u20ac"),u.a.createElement("th",{className:"text-right"},"Valore \u20ac"),u.a.createElement("th",{className:"text-right"},"Utile \u20ac"),u.a.createElement("th",{className:"text-right"},"Margine %"),u.a.createElement("th",{className:"text-right"},"Offerte \xbd"),u.a.createElement("th",{className:"text-right"},"Offerte %"))),u.a.createElement("tbody",null,G.map(function(e,n){return f[e].relationships[l].data&&f[e].relationships[l].data.id===t?(a++,r+=f[e].attributes.quantity,i+=f[e].attributes.amount,m.push(f[e].attributes.mean),o+=f[e].attributes.profit,p.push(f[e].attributes.margin),s+=f[e].attributes.promo_amount,h.push(f[e].attributes.promo_perc),V===n+1&&(R.datasets[0].data.push(o.toFixed(2)),N.datasets[0].data.push((Object(D.a)(p)/p.length).toFixed(2))),u.a.createElement("tr",{key:e},u.a.createElement("td",{className:"text-left"},d[f[e].relationships.product.data.id].description),u.a.createElement("td",{className:"text-right"},f[e].attributes.quantity),u.a.createElement("td",{className:"text-right"},u.a.createElement(M.a,{value:f[e].attributes.mean,displayType:"text",thousandSeparator:".",decimalSeparator:",",decimalScale:2,fixedDecimalScale:!0,renderText:function(e){return u.a.createElement("div",null,e)}})),u.a.createElement("td",{className:"text-right"},u.a.createElement(M.a,{value:f[e].attributes.amount,displayType:"text",thousandSeparator:".",decimalSeparator:",",decimalScale:2,fixedDecimalScale:!0,renderText:function(e){return u.a.createElement("div",null,e)}})),u.a.createElement("td",{className:"text-right"},u.a.createElement(M.a,{value:f[e].attributes.profit,displayType:"text",thousandSeparator:".",decimalSeparator:",",decimalScale:2,fixedDecimalScale:!0,renderText:function(e){return u.a.createElement("div",null,e)}})),u.a.createElement("td",{className:"text-right"},f[e].attributes.margin.toFixed(2)),u.a.createElement("td",{className:"text-right"},u.a.createElement(M.a,{value:f[e].attributes.promo_amount,displayType:"text",thousandSeparator:".",decimalSeparator:",",decimalScale:2,fixedDecimalScale:!0,renderText:function(e){return u.a.createElement("div",null,e)}})),u.a.createElement("td",{className:"text-right"},f[e].attributes.promo_perc.toFixed(2)))):null})),u.a.createElement("tfoot",null,u.a.createElement("tr",null,u.a.createElement("th",null,"TOTALI: ",a),u.a.createElement("td",{className:"text-right"},r),u.a.createElement("td",{className:"text-right"},u.a.createElement(M.a,{value:Object(D.a)(m),displayType:"text",thousandSeparator:".",decimalSeparator:",",decimalScale:2,fixedDecimalScale:!0,renderText:function(e){return u.a.createElement("div",null,e)}})),u.a.createElement("td",{className:"text-right"},u.a.createElement(M.a,{value:i,displayType:"text",thousandSeparator:".",decimalSeparator:",",decimalScale:2,fixedDecimalScale:!0,renderText:function(e){return u.a.createElement("div",null,e)}})),u.a.createElement("td",{className:"text-right"},u.a.createElement(M.a,{value:o,displayType:"text",thousandSeparator:".",decimalSeparator:",",decimalScale:2,fixedDecimalScale:!0,renderText:function(e){return u.a.createElement("div",null,e)}})),u.a.createElement("td",{className:"text-right"},(Object(D.a)(p)/p.length).toFixed(2)),u.a.createElement("td",{className:"text-right"},s.toFixed(2)),u.a.createElement("td",{className:"text-right"},(Object(D.a)(h)/h.length).toFixed(2)))))))))}),a=u.a.createElement(v.a,null,u.a.createElement(x.a,{sm:6},u.a.createElement(g.a,null,u.a.createElement(S.a,null,"Profitto"),u.a.createElement(E.a,null,u.a.createElement(j.Bar,{data:R,options:A()})))),u.a.createElement(x.a,{sm:6},u.a.createElement(g.a,null,u.a.createElement(S.a,null,"Margine"),u.a.createElement(E.a,null,u.a.createElement(j.Bar,{data:N,options:A()})))))}return u.a.createElement(h.a,{title:"Vendite prodotti",breadcrumbs:[{name:"vendite prodotti",active:!0}]},u.a.createElement(v.a,null,u.a.createElement(x.a,null,u.a.createElement(g.a,{className:"mb-3"},u.a.createElement(S.a,null,"Filtri"),u.a.createElement(E.a,null,u.a.createElement(C.a,{onSubmit:this.handleSubmit},u.a.createElement(w.a,{onChange:this.handleFilterChange.bind(this),fromStartDate:this.state.filters.from,toStartDate:this.state.filters.to}),u.a.createElement(B.a,{onChange:this.handleFilterChange.bind(this)}),u.a.createElement(v.a,null,u.a.createElement(T.a,{onChange:this.handleFilterChange.bind(this)})),u.a.createElement(v.a,null,u.a.createElement(x.a,null,u.a.createElement(y.a,{color:"primary",disabled:this.props.loading&&this.state.searchClicked,onClick:this.handleSubmit},"Cerca"),"\xa0",u.a.createElement(y.a,{color:"secondary",disabled:this.props.loading&&this.state.searchClicked,onClick:this.handleReset},"Reset")))))),a,t)),u.a.createElement(_.a,{dismissible:!1,notifications:this.props.notifications,style:k.d}))}}]),t}(P.a);V.contextTypes={store:m.a.object},V.propTypes={notifications:m.a.array,stats:m.a.object,affiliates:m.a.object,products:m.a.object,groups:m.a.object,departments:m.a.object,families:m.a.object,loading:m.a.bool,error:m.a.bool,pdfAvaiable:m.a.bool};t.default=Object(p.connect)(function(e){return{stats:e.statistics.productTotalStatistics,affiliates:e.statistics.affiliates,products:e.statistics.products,groups:e.statistics.groups,departments:e.statistics.departments,failies:e.statistics.families,loading:e.statistics.loading,error:e.statistics.error,pdfAvaiable:e.statistics.pdfAvaiable,notifications:e.notifications}},function(e){return{onLoadStats:function(t,a,r,n,l){return e(f.l(t,a,r,n,l))}}})(V)}}]);
//# sourceMappingURL=11.4bc7759c.chunk.js.map